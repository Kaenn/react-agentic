# Milestone v1.0: MVP

**Status:** ✅ SHIPPED 2026-01-21
**Phases:** 1-7
**Total Plans:** 17

## Overview

This roadmap delivered a TSX-to-Markdown transpiler in 7 phases following compiler architecture best practices. The journey began with IR type definitions and emitter (enabling testable, maintainable code), progressed through element coverage and CLI interface, and concluded with composition features, production polish, and example validation. Build order followed research guidance: IR first, emitter second, transformer third, CLI last.

## Phases

### Phase 1: Foundation & IR

**Goal**: Establish project infrastructure and define intermediate representation that decouples parsing from generation
**Depends on**: Nothing (first phase)
**Plans**: 2 plans

Plans:
- [x] 01-01-PLAN.md — Project setup (package.json, tsconfig, dependencies)
- [x] 01-02-PLAN.md — IR type definitions and Markdown emitter

**Details:**
- TypeScript 5.9.3 with NodeNext module resolution
- Vitest 4.0.17 with v8 coverage provider
- ESM-first configuration (type: module)
- IR uses discriminated unions with kind property
- Emitter uses class with listStack for nested list context tracking

### Phase 2: Core Transpilation

**Goal**: Parse TSX files and transform basic HTML-like elements to Markdown via IR
**Depends on**: Phase 1
**Plans**: 3 plans

Plans:
- [x] 02-01-PLAN.md — ts-morph parser setup and JSX AST traversal
- [x] 02-02-PLAN.md — Transformer for basic elements (headings, paragraphs, text formatting)
- [x] 02-03-PLAN.md — Transformer for lists, blockquotes, code blocks, and links

**Details:**
- ts-morph ^27.0.2 for TSX parsing with JsxEmit.Preserve
- useInMemoryFileSystem: true in Project for in-memory parsing
- JSX expressions {' '} supported for explicit spacing
- List items contain BlockNode[] children, not direct InlineNode[]

### Phase 3: Full Element Coverage

**Goal**: Complete element support including Command frontmatter, XML blocks, and raw markdown passthrough
**Depends on**: Phase 2
**Plans**: 2 plans

Plans:
- [x] 03-01-PLAN.md — Command component props to YAML frontmatter
- [x] 03-02-PLAN.md — Named div blocks and Markdown passthrough component

**Details:**
- allowedTools prop maps to allowed-tools (kebab-case) in YAML frontmatter
- div with name attribute becomes XmlBlock with that name
- Markdown component passes content through as raw
- XML name validation prevents invalid tag names at transpile time

### Phase 4: CLI Interface

**Goal**: Usable CLI tool with build command, glob processing, and proper output conventions
**Depends on**: Phase 3
**Plans**: 2 plans

Plans:
- [x] 04-01-PLAN.md — CLI scaffolding with commander (help, version, basic structure)
- [x] 04-02-PLAN.md — Build command with glob processing and colored output

**Details:**
- CLI uses Commander.js for automatic --help/--version handling
- tsup builds both library (index) and CLI entry points
- picocolors auto-respects NO_COLOR, FORCE_COLOR, TTY detection
- Build errors accumulated and reported at end, exit code 1 if any fail

### Phase 5: Composition

**Goal**: Enable props spreading and component composition for reusable command fragments
**Depends on**: Phase 4
**Plans**: 2 plans

Plans:
- [x] 05-01-PLAN.md — Static props spreading resolution
- [x] 05-02-PLAN.md — Component composition and fragment flattening

**Details:**
- Only simple identifiers supported for spread (no expressions)
- Only relative imports supported for component composition
- Component props not supported in v1 (throws if props passed)
- Circular imports detected and throw descriptive error

### Phase 6: Watch & Error Handling

**Goal**: Production-ready CLI with watch mode, dry run, and developer-friendly error messages
**Depends on**: Phase 5
**Plans**: 3 plans

Plans:
- [x] 06-01-PLAN.md — Source-located error messages with TypeScript-style formatting
- [x] 06-02-PLAN.md — Dry run mode with build tree preview
- [x] 06-03-PLAN.md — Watch mode with chokidar and debouncing

**Details:**
- TranspileError extends Error with optional location/sourceCode properties
- Error format follows TypeScript style: file:line:col - error: message
- Chokidar with ignoreInitial:true to prevent double initial build
- 200ms default debounce delay to coalesce rapid changes

### Phase 7: Example Validation

**Goal**: Fix and validate the example command TSX file to demonstrate correct syntax and all supported features
**Depends on**: Phase 6
**Plans**: 3 plans

Plans:
- [x] 07-01-PLAN.md — Fix and validate example command TSX file
- [x] 07-02-PLAN.md — Close UAT gaps: JSX types, list item fix, src/app location
- [x] 07-03-PLAN.md — Fix space preservation in list items with bold text

**Details:**
- Example uses commit-helper theme for practical Claude Code demonstration
- @types/react for JSX runtime type support
- Global JSX namespace augmentation for Command/Markdown types
- Default watch path: src/app/**/*.tsx when no patterns provided

---

## Milestone Summary

**Key Decisions:**

- Decision: ts-morph over Babel (Rationale: Full type resolution, not just syntax parsing)
- Decision: CLI-first over plugin (Rationale: Simpler initial scope, can add plugins later)
- Decision: IR uses discriminated unions (Rationale: Type-safe switching with assertNever)
- Decision: Chokidar with debouncing (Rationale: Research pitfall identified in planning)
- Decision: JSX whitespace pattern {' '} (Rationale: Expected JSX behavior, not a bug)

**Issues Resolved:**

- Fixed nested list double-indentation in emitter
- Fixed createProject filesystem access for CLI
- Fixed JSX expression handling in list items for space preservation
- Fixed TypeScript strict mode error handling in watcher

**Issues Deferred:**

- Component props support (v2)
- Multi-block fragment returns (v2)
- Package import support (v2)

**Technical Debt Incurred:**

- None significant - clean v1 implementation

---

_For current project status, see .planning/ROADMAP.md_
