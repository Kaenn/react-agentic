---
phase: 13-conditional-logic
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/jsx.ts
  - src/ir/nodes.ts
autonomous: true

must_haves:
  truths:
    - "If component exists with test prop and children"
    - "Else component exists with children prop"
    - "IfNode and ElseNode types are defined in IR"
    - "BlockNode union includes if and else kinds"
  artifacts:
    - path: "src/jsx.ts"
      provides: "If and Else component stubs with TypeScript types"
      contains: "export function If"
    - path: "src/ir/nodes.ts"
      provides: "IfNode and ElseNode interfaces"
      contains: "interface IfNode"
  key_links:
    - from: "src/jsx.ts"
      to: "src/ir/nodes.ts"
      via: "Component props match IR node structure"
      pattern: "kind: 'if'"
---

<objective>
Add IR node types and JSX component stubs for If/Else conditional logic.

Purpose: Establish the type foundation for conditional blocks in react-agentic. The If component will enable `<If test="condition">content</If>` syntax, while Else will provide the "otherwise" branch.

Output: IfNode/ElseNode in IR, If/Else components in jsx.ts, updated BlockNode union.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-conditional-logic/13-RESEARCH.md

@src/jsx.ts
@src/ir/nodes.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add IfNode and ElseNode to IR</name>
  <files>src/ir/nodes.ts</files>
  <action>
Add two new node interfaces to the Block Nodes section:

```typescript
/**
 * Conditional If block
 * Emits as **If {test}:** prose pattern
 */
export interface IfNode {
  kind: 'if';
  /** Shell test expression (preserved verbatim) */
  test: string;
  /** "then" block content */
  children: BlockNode[];
}

/**
 * Else block (sibling to If)
 * Emits as **Otherwise:** prose pattern
 */
export interface ElseNode {
  kind: 'else';
  /** "otherwise" block content */
  children: BlockNode[];
}
```

Update the BlockNode union type to include IfNode and ElseNode:

```typescript
export type BlockNode =
  | HeadingNode
  | ParagraphNode
  | ListNode
  | CodeBlockNode
  | BlockquoteNode
  | ThematicBreakNode
  | XmlBlockNode
  | RawMarkdownNode
  | SpawnAgentNode
  | AssignNode
  | IfNode
  | ElseNode;
```

Place the interfaces after AssignNode and before the BlockNode union (maintain alphabetical-ish ordering with related nodes together).
  </action>
  <verify>
Run `npx tsc --noEmit` to verify TypeScript compiles without errors.
Verify IfNode and ElseNode are exported: `grep -E "(IfNode|ElseNode)" src/ir/nodes.ts`
  </verify>
  <done>IfNode and ElseNode interfaces exist with correct kind discriminators and children arrays. BlockNode union includes both new types.</done>
</task>

<task type="auto">
  <name>Task 2: Add If and Else components to jsx.ts</name>
  <files>src/jsx.ts</files>
  <action>
Add component definitions after the Assign component section. Follow the existing pattern of Props interface + stub function:

```typescript
// ============================================================================
// Conditional Logic (If/Else components)
// ============================================================================

/**
 * Props for the If component
 */
export interface IfProps {
  /** Shell test expression (e.g., "[ -f config.json ]") */
  test: string;
  /** "then" block content */
  children?: ReactNode;
}

/**
 * Props for the Else component
 */
export interface ElseProps {
  /** "otherwise" block content */
  children?: ReactNode;
}

/**
 * If component - conditional block for prose-based conditionals
 *
 * This is a compile-time component transformed by react-agentic.
 * It's never executed at runtime. Emits as **If {test}:** pattern.
 *
 * @example
 * <If test="[ -f config.json ]">
 *   <p>Config found, loading...</p>
 * </If>
 *
 * @example with VariableRef interpolation
 * const phaseDir = useVariable("PHASE_DIR", { bash: `ls -d test` });
 * <If test={`[ -z ${phaseDir.ref} ]`}>
 *   <p>No phase directory found.</p>
 * </If>
 */
export function If(_props: IfProps): null {
  return null;
}

/**
 * Else component - optional sibling to If
 *
 * Must appear immediately after a closing </If> tag.
 * It's never executed at runtime. Emits as **Otherwise:** pattern.
 *
 * @example
 * <If test="[ -f config.json ]">
 *   <p>Config found.</p>
 * </If>
 * <Else>
 *   <p>Config missing.</p>
 * </Else>
 */
export function Else(_props: ElseProps): null {
  return null;
}
```

Add exports to the existing export pattern if using named exports (the file currently uses inline exports, so no additional export statement needed).
  </action>
  <verify>
Run `npx tsc --noEmit` to verify TypeScript compiles.
Verify exports: `grep -E "export function (If|Else)" src/jsx.ts`
  </verify>
  <done>If and Else components exported from jsx.ts with proper TypeScript types. IfProps has required test prop (string), both have optional children.</done>
</task>

</tasks>

<verification>
1. TypeScript compiles: `npx tsc --noEmit`
2. IR exports: `grep -E "IfNode|ElseNode" src/ir/nodes.ts`
3. JSX exports: `grep -E "export function (If|Else)" src/jsx.ts`
4. BlockNode includes new types: `grep -E "IfNode|ElseNode" src/ir/nodes.ts | grep BlockNode`
</verification>

<success_criteria>
- IfNode interface has kind: 'if', test: string, children: BlockNode[]
- ElseNode interface has kind: 'else', children: BlockNode[]
- BlockNode union includes IfNode | ElseNode
- If component accepts test (required) and children (optional) props
- Else component accepts children (optional) prop
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/13-conditional-logic/13-01-SUMMARY.md`
</output>
