---
phase: 22-semantic-components
plan: 02
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - src/workflow/sections/semantic.ts
  - src/workflow/sections/index.ts
  - src/jsx.ts
  - src/ir/nodes.ts
autonomous: true

must_haves:
  truths:
    - "OfferNext component accepts routes array and emits offer_next XML with bullet list"
    - "DeviationRules, CommitRules, WaveExecution, CheckpointHandling emit named XML sections"
    - "All XML wrapper components accept children and emit snake_case tags"
  artifacts:
    - path: "src/workflow/sections/semantic.ts"
      provides: "OfferNext, DeviationRules, CommitRules, WaveExecution, CheckpointHandling components"
      exports: ["OfferNext", "OfferNextRoute", "OfferNextProps", "DeviationRules", "CommitRules", "WaveExecution", "CheckpointHandling", "XmlWrapperProps"]
    - path: "src/ir/nodes.ts"
      provides: "OfferNextNode IR node type"
      contains: "OfferNextNode"
  key_links:
    - from: "src/jsx.ts"
      to: "src/workflow/sections/semantic.ts"
      via: "re-export"
      pattern: "export.*OfferNext"
---

<objective>
Add OfferNext component with typed routes and XML wrapper components (DeviationRules, CommitRules, WaveExecution, CheckpointHandling).

Purpose: Complete the semantic components set with route navigation and specialized XML section wrappers for GSD workflow patterns.
Output: All remaining component stubs, props interfaces, and IR nodes for OfferNext ready for transformer/emitter in Plan 03.
</objective>

<execution_context>
@/Users/glenninizan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/glenninizan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/22-semantic-components/22-CONTEXT.md
@.planning/phases/22-semantic-components/22-RESEARCH.md
@.planning/phases/22-semantic-components/22-01-SUMMARY.md

@src/workflow/sections/semantic.ts
@src/ir/nodes.ts
@src/jsx.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add OfferNext component with typed routes</name>
  <files>src/workflow/sections/semantic.ts, src/ir/nodes.ts</files>
  <action>
**In `src/workflow/sections/semantic.ts`:**

Add OfferNext interfaces with **explicit export keywords**:
```typescript
// Route definition for OfferNext
export interface OfferNextRoute {
  name: string;
  description?: string;
  path: string;
}

export interface OfferNextProps {
  routes: OfferNextRoute[];
}
```

Add stub function:
```typescript
/**
 * OfferNext component - emits route navigation section
 *
 * @example
 * <OfferNext routes={[
 *   { name: "Execute", description: "Run the plan", path: "/gsd:execute-phase" },
 *   { name: "Revise", path: "/gsd:plan-phase --revise" }
 * ]} />
 *
 * Outputs:
 * <offer_next>
 * - **Execute**: Run the plan
 *   `/gsd:execute-phase`
 * - **Revise**
 *   `/gsd:plan-phase --revise`
 * </offer_next>
 */
export function OfferNext(_props: OfferNextProps): null {
  return null;
}
```

**In `src/ir/nodes.ts`:**

Add OfferNextNode with **explicit export keywords**:
```typescript
export interface OfferNextRouteData {
  name: string;
  description?: string;
  path: string;
}

export interface OfferNextNode {
  kind: 'offerNext';
  routes: OfferNextRouteData[];
}
```

Add `OfferNextNode` to the `BlockNode` union type.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>OfferNext component and OfferNextNode IR type defined</done>
</task>

<task type="auto">
  <name>Task 2: Add XML wrapper section components</name>
  <files>src/workflow/sections/semantic.ts</files>
  <action>
Add four specialized XML wrapper components to `src/workflow/sections/semantic.ts`.

These are convenience components that emit specific XML tags. They use `XmlSection` under the hood conceptually but are separate exports for discoverability.

Define XmlWrapperProps with **explicit export keyword**:
```typescript
// Common props for XML wrapper components
export interface XmlWrapperProps {
  children: ReactNode;
}
```

Add component stubs with export keywords:
```typescript
/**
 * DeviationRules component - emits deviation_rules XML section
 * Used in GSD workflows for handling plan deviations
 */
export function DeviationRules(_props: XmlWrapperProps): null {
  return null;
}

/**
 * CommitRules component - emits commit_rules XML section
 * Used in GSD workflows for git commit guidelines
 */
export function CommitRules(_props: XmlWrapperProps): null {
  return null;
}

/**
 * WaveExecution component - emits wave_execution XML section
 * Used in GSD workflows for parallel execution patterns
 */
export function WaveExecution(_props: XmlWrapperProps): null {
  return null;
}

/**
 * CheckpointHandling component - emits checkpoint_handling XML section
 * Used in GSD workflows for verification checkpoints
 */
export function CheckpointHandling(_props: XmlWrapperProps): null {
  return null;
}
```

Note: These components do NOT need separate IR nodes. The transformer will convert them to `XmlBlockNode` with the appropriate snake_case `name` (e.g., `deviation_rules`).
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit src/workflow/sections/semantic.ts`</verify>
  <done>DeviationRules, CommitRules, WaveExecution, CheckpointHandling components defined with exported XmlWrapperProps type</done>
</task>

<task type="auto">
  <name>Task 3: Update exports in index.ts and jsx.ts</name>
  <files>src/workflow/sections/index.ts, src/jsx.ts</files>
  <action>
**Update `src/workflow/sections/index.ts`:**
Add new exports (append to existing exports from Plan 01):
```typescript
export {
  // From Plan 01
  ExecutionContext,
  SuccessCriteria,
  XmlSection,
  type ExecutionContextProps,
  type SuccessCriteriaProps,
  type SuccessCriteriaItem,
  type XmlSectionProps,
  // Plan 02 additions
  OfferNext,
  DeviationRules,
  CommitRules,
  WaveExecution,
  CheckpointHandling,
  type OfferNextProps,
  type OfferNextRoute,
  type XmlWrapperProps,
} from './semantic.js';
```

**Update `src/jsx.ts`:**
Add new exports to the Sections section:
```typescript
// Semantic section components
export {
  ExecutionContext,
  SuccessCriteria,
  XmlSection,
  OfferNext,
  DeviationRules,
  CommitRules,
  WaveExecution,
  CheckpointHandling,
  type ExecutionContextProps,
  type SuccessCriteriaProps,
  type SuccessCriteriaItem,
  type XmlSectionProps,
  type OfferNextProps,
  type OfferNextRoute,
  type XmlWrapperProps,
} from './workflow/sections/index.js';
```
  </action>
  <verify>Full build passes: `npm run build`</verify>
  <done>All semantic components exported from jsx.ts</done>
</task>

</tasks>

<verification>
1. `npm run build` passes without errors
2. All new components visible in dist/jsx.d.ts
3. OfferNextNode in BlockNode union
</verification>

<success_criteria>
- OfferNext with typed routes exported
- DeviationRules, CommitRules, WaveExecution, CheckpointHandling exported
- OfferNextNode added to IR nodes
- All types properly exported for user consumption
</success_criteria>

<output>
After completion, create `.planning/phases/22-semantic-components/22-02-SUMMARY.md`
</output>
