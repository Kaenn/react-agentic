---
phase: 14-agent-output-schema
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/jsx.ts
autonomous: true

must_haves:
  truths:
    - "AgentStatus type exists with five standard status codes"
    - "BaseOutput interface requires status field"
    - "Agent component accepts two generic type parameters"
    - "TOutput defaults to unknown for backward compatibility"
  artifacts:
    - path: "src/jsx.ts"
      provides: "AgentStatus type, BaseOutput interface, updated Agent generic"
      contains: "export type AgentStatus"
    - path: "src/jsx.ts"
      provides: "BaseOutput with status and optional message"
      contains: "export interface BaseOutput"
  key_links:
    - from: "AgentStatus"
      to: "BaseOutput"
      via: "status property type"
      pattern: "status: AgentStatus"
---

<objective>
Add AgentStatus and BaseOutput types for standardized agent output contracts.

Purpose: Define the type foundation for agent outputs. AgentStatus provides HTTP-like status codes (SUCCESS, BLOCKED, NOT_FOUND, ERROR, CHECKPOINT), and BaseOutput establishes the required structure all agent outputs must follow. The Agent component is updated to accept TOutput as a second generic parameter.

Output: AgentStatus type, BaseOutput interface, Agent<TInput, TOutput> generic signature in jsx.ts.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-agent-output-schema/14-RESEARCH.md

@src/jsx.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add AgentStatus and BaseOutput types</name>
  <files>src/jsx.ts</files>
  <action>
Add new types after the VariableRef section (before conditional logic section). Create a new section:

```typescript
// ============================================================================
// Agent Output Types
// ============================================================================

/**
 * Standard agent return status codes (HTTP-like semantics)
 *
 * - SUCCESS: Agent completed task successfully
 * - BLOCKED: Agent cannot proceed, needs external input/action
 * - NOT_FOUND: Requested resource or information not found
 * - ERROR: Agent encountered an error during execution
 * - CHECKPOINT: Agent reached milestone, pausing for verification
 */
export type AgentStatus =
  | 'SUCCESS'
  | 'BLOCKED'
  | 'NOT_FOUND'
  | 'ERROR'
  | 'CHECKPOINT';

/**
 * Base interface all agent outputs must extend
 *
 * Provides standard structure for agent return values with required
 * status code and optional human-readable message.
 *
 * @example
 * export interface ResearcherOutput extends BaseOutput {
 *   // SUCCESS-specific fields
 *   confidence?: 'HIGH' | 'MEDIUM' | 'LOW';
 *   findings?: string[];
 *   // BLOCKED-specific fields
 *   blockedBy?: string;
 * }
 */
export interface BaseOutput {
  /** Required: Agent completion status */
  status: AgentStatus;
  /** Optional: Human-readable status message */
  message?: string;
}
```

Place this section after the `useVariable` function and before the `// ============================================================================` line for Conditional Logic.
  </action>
  <verify>
Run `npx tsc --noEmit` to verify TypeScript compiles.
Verify exports: `grep -E "AgentStatus|BaseOutput" src/jsx.ts`
  </verify>
  <done>AgentStatus type exported with 5 status codes. BaseOutput interface exported with required status and optional message fields.</done>
</task>

<task type="auto">
  <name>Task 2: Update Agent generic to support TOutput</name>
  <files>src/jsx.ts</files>
  <action>
Modify the existing AgentProps interface and Agent function to accept a second type parameter TOutput:

1. Update AgentProps interface:
```typescript
/**
 * Props for the Agent component
 * @typeParam TInput - Type interface for agent input contract (compile-time only)
 * @typeParam TOutput - Type interface for agent output contract (compile-time only)
 */
export interface AgentProps<TInput = unknown, TOutput = unknown> {
  /** Agent name (used in frontmatter and Task() spawning) */
  name: string;
  /** Agent description (used in frontmatter) */
  description: string;
  /** Space-separated tool names (optional) */
  tools?: string;
  /** Terminal color for agent output (optional) */
  color?: string;
  /** Subfolder for output path (optional) - determines namespaced agent name */
  folder?: string;
  /** Agent body content */
  children?: ReactNode;
  // TInput and TOutput are compile-time only - used for cross-file type validation
}
```

2. Update Agent function:
```typescript
/**
 * Agent component - creates a Claude Code agent with frontmatter
 *
 * This is a compile-time component transformed by react-agentic.
 * It's never executed at runtime.
 *
 * @typeParam TInput - Type interface for agent input contract (compile-time only)
 * @typeParam TOutput - Type interface for agent output contract (compile-time only, must extend BaseOutput)
 * @example
 * // Define input and output contracts
 * export interface ResearcherInput { phase: string; description: string; }
 * export interface ResearcherOutput extends BaseOutput {
 *   confidence?: 'HIGH' | 'MEDIUM' | 'LOW';
 *   findings?: string[];
 * }
 *
 * // Use generics to declare contracts
 * <Agent<ResearcherInput, ResearcherOutput> name="researcher" description="Research topics" tools="Read Grep Glob">
 *   <h1>Role</h1>
 *   <p>You are a researcher that finds information using code analysis tools.</p>
 * </Agent>
 */
export function Agent<TInput = unknown, TOutput = unknown>(_props: AgentProps<TInput, TOutput>): null {
  return null;
}
```

Note: Both type parameters default to `unknown` for backward compatibility with existing single-param usage like `<Agent<ResearcherInput>>`.
  </action>
  <verify>
Run `npx tsc --noEmit` to verify TypeScript compiles.
Verify the generic signature: `grep -A5 "export function Agent" src/jsx.ts`
  </verify>
  <done>Agent component accepts two generic parameters (TInput, TOutput), both defaulting to unknown. Existing single-param usage remains compatible.</done>
</task>

</tasks>

<verification>
1. TypeScript compiles: `npx tsc --noEmit`
2. AgentStatus exported: `grep "export type AgentStatus" src/jsx.ts`
3. BaseOutput exported: `grep "export interface BaseOutput" src/jsx.ts`
4. Agent has two generics: `grep -A2 "export function Agent" src/jsx.ts`
5. Backward compat: Build existing test files to verify they still work
</verification>

<success_criteria>
- AgentStatus is a union type of 5 string literals (SUCCESS, BLOCKED, NOT_FOUND, ERROR, CHECKPOINT)
- BaseOutput interface has required `status: AgentStatus` and optional `message?: string`
- Agent<TInput, TOutput> accepts two type parameters, both defaulting to unknown
- Existing `<Agent<TInput>>` single-param usage compiles without changes
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/14-agent-output-schema/14-01-SUMMARY.md`
</output>
