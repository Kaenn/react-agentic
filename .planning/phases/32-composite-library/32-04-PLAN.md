---
phase: 32-composite-library
plan: 04
type: execute
wave: 3
depends_on: ["32-02", "32-03"]
files_modified:
  - src/composites/StepSection.tsx
  - src/composites/DataTable.tsx
  - src/composites/BulletList.tsx
  - src/composites/FileContext.tsx
  - src/composites/index.ts
  - tests/composites/presentation.test.ts
autonomous: true

must_haves:
  truths:
    - "All presentation composites wrap primitives with enhanced patterns"
    - "StepSection, DataTable, BulletList, FileContext have rich JSDoc"
    - "All composites importable from react-agentic/composites"
    - "Full build produces dist/composites/ with all exports"
  artifacts:
    - path: "src/composites/StepSection.tsx"
      provides: "StepSection composite"
      exports: ["StepSection", "StepSectionProps"]
      min_lines: 40
    - path: "src/composites/DataTable.tsx"
      provides: "DataTable composite"
      exports: ["DataTable", "DataTableProps"]
      min_lines: 40
    - path: "src/composites/BulletList.tsx"
      provides: "BulletList composite"
      exports: ["BulletList", "BulletListProps"]
      min_lines: 30
    - path: "src/composites/FileContext.tsx"
      provides: "FileContext composite"
      exports: ["FileContext", "FileContextProps"]
      min_lines: 40
    - path: "tests/composites/presentation.test.ts"
      provides: "Tests for presentation composites"
      min_lines: 80
  key_links:
    - from: "src/composites/index.ts"
      to: "all composites"
      via: "barrel export"
      pattern: "export.*from"
---

<objective>
Create remaining presentation composites and finalize composite library

Purpose: Complete the composite library with presentation wrappers (StepSection, DataTable, BulletList, FileContext) that enhance the primitives with common patterns. Verify the complete library is importable and serves as reference implementations.

Output: Four additional composites with rich JSDoc, all composites exported from barrel, comprehensive tests.
</objective>

<execution_context>
@/Users/glenninizan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/glenninizan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-composite-library/32-CONTEXT.md
@.planning/phases/32-composite-library/32-RESEARCH.md
@.planning/phases/32-composite-library/32-02-SUMMARY.md
@.planning/phases/32-composite-library/32-03-SUMMARY.md
@src/primitives/step.ts
@src/primitives/structured.ts
@src/workflow/sections/semantic.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create StepSection composite</name>
  <files>src/composites/StepSection.tsx</files>
  <action>
Create StepSection composite that wraps Step with enhanced content support.

**Value-add over raw Step:**
- Optional description prop for step summary
- Built-in substeps support via children
- Cleaner API for common step patterns

**Implementation:**
```tsx
import type { ReactNode } from 'react';
import { Step, type StepVariant } from '../primitives/step.js';

/**
 * Enhanced step component with description and substeps support
 *
 * Wraps Step primitive with additional conveniences for workflow sections.
 *
 * @param props - Component props
 * @param props.number - Step number (string for substeps like "1.1")
 * @param props.name - Step title
 * @param props.description - Optional step description/summary
 * @param props.variant - Output format (heading, bold, xml)
 * @param props.children - Step body content or substeps
 *
 * @example Basic step
 * ```tsx
 * import { StepSection } from 'react-agentic/composites';
 *
 * <StepSection number={1} name="Setup Environment">
 *   <p>Install dependencies and configure the workspace.</p>
 * </StepSection>
 * ```
 *
 * @example With description
 * ```tsx
 * <StepSection
 *   number={2}
 *   name="Configure Settings"
 *   description="Set up application configuration for your environment"
 * >
 *   <p>Edit config.json with your API keys.</p>
 * </StepSection>
 * ```
 *
 * @example Substeps
 * ```tsx
 * <StepSection number="3.1" name="Install dependencies" variant="bold">
 *   <p>Run npm install in the project root.</p>
 * </StepSection>
 * ```
 *
 * @see {@link Step} for the underlying step primitive
 */
export interface StepSectionProps {
  /** Step number - explicit, supports substeps like "1.1" */
  number: number | string;
  /** Step name/title */
  name: string;
  /** Optional step description shown before body */
  description?: string;
  /** Output format variant */
  variant?: StepVariant;
  /** Step body content */
  children?: ReactNode;
}

export const StepSection = ({
  number,
  name,
  description,
  variant,
  children
}: StepSectionProps): ReactNode => {
  return (
    <Step number={number} name={name} variant={variant}>
      {description && <p><i>{description}</i></p>}
      {children}
    </Step>
  );
};
```
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit src/composites/StepSection.tsx`
Has JSDoc examples: `grep -c "@example" src/composites/StepSection.tsx` shows 3+
  </verify>
  <done>StepSection.tsx exists with Step wrapper and description support</done>
</task>

<task type="auto">
  <name>Task 2: Create DataTable and BulletList composites</name>
  <files>src/composites/DataTable.tsx, src/composites/BulletList.tsx</files>
  <action>
Create DataTable and BulletList composites that wrap Table and List.

**DataTable - value-add:**
- Optional caption prop
- Optional emptyMessage for empty data
- Cleaner API with meaningful name

**BulletList - value-add:**
- Title prop for list header
- Simplified API for bullet lists (most common case)

**DataTable Implementation:**
```tsx
import type { ReactNode } from 'react';
import { Table, type TableAlignment } from '../primitives/structured.js';

/**
 * Enhanced table with caption and empty state support
 *
 * Wraps Table primitive with common table patterns.
 *
 * @param props - Component props
 * @param props.headers - Column headers
 * @param props.rows - Data rows (2D array)
 * @param props.align - Per-column alignment
 * @param props.caption - Optional table caption
 * @param props.emptyMessage - Message when rows is empty
 *
 * @example Basic table
 * ```tsx
 * import { DataTable } from 'react-agentic/composites';
 *
 * <DataTable
 *   headers={["Name", "Status", "Score"]}
 *   rows={[
 *     ["Alice", "Active", 95],
 *     ["Bob", "Pending", 87],
 *   ]}
 * />
 * ```
 *
 * @example With caption and alignment
 * ```tsx
 * <DataTable
 *   caption="Test Results Summary"
 *   headers={["Test", "Result", "Time"]}
 *   rows={[["Unit", "Pass", "2.3s"], ["E2E", "Pass", "45s"]]}
 *   align={["left", "center", "right"]}
 * />
 * ```
 *
 * @example Empty state
 * ```tsx
 * <DataTable
 *   headers={["Name", "Value"]}
 *   rows={[]}
 *   emptyMessage="No data available"
 * />
 * ```
 *
 * @see {@link Table} for the underlying table primitive
 */
export interface DataTableProps {
  /** Column headers */
  headers?: string[];
  /** Data rows */
  rows: (string | number | null | undefined)[][];
  /** Per-column alignment */
  align?: TableAlignment[];
  /** Content for empty cells */
  emptyCell?: string;
  /** Optional table caption */
  caption?: string;
  /** Message when rows is empty */
  emptyMessage?: string;
}

export const DataTable = ({
  headers,
  rows,
  align,
  emptyCell,
  caption,
  emptyMessage
}: DataTableProps): ReactNode => {
  // Handle empty state
  if (rows.length === 0 && emptyMessage) {
    return <p><i>{emptyMessage}</i></p>;
  }

  return (
    <>
      {caption && <p><b>{caption}</b></p>}
      <Table headers={headers} rows={rows} align={align} emptyCell={emptyCell} />
    </>
  );
};
```

**BulletList Implementation:**
```tsx
import type { ReactNode } from 'react';
import { List } from '../primitives/structured.js';

/**
 * Enhanced bullet list with title support
 *
 * Wraps List primitive for common bullet list patterns.
 * For numbered lists, use List directly with ordered={true}.
 *
 * @param props - Component props
 * @param props.items - List items
 * @param props.title - Optional list title/header
 *
 * @example Basic bullet list
 * ```tsx
 * import { BulletList } from 'react-agentic/composites';
 *
 * <BulletList items={["First item", "Second item", "Third item"]} />
 * ```
 *
 * @example With title
 * ```tsx
 * <BulletList
 *   title="Prerequisites"
 *   items={["Node.js 18+", "npm or yarn", "Git"]}
 * />
 * ```
 *
 * @see {@link List} for the underlying list primitive
 */
export interface BulletListProps {
  /** List items */
  items: (string | number)[];
  /** Optional list title */
  title?: string;
}

export const BulletList = ({ items, title }: BulletListProps): ReactNode => {
  return (
    <>
      {title && <p><b>{title}</b></p>}
      <List items={items} />
    </>
  );
};
```
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit src/composites/DataTable.tsx src/composites/BulletList.tsx`
DataTable has @example: `grep -c "@example" src/composites/DataTable.tsx` shows 3+
BulletList has @example: `grep -c "@example" src/composites/BulletList.tsx` shows 2+
  </verify>
  <done>DataTable.tsx and BulletList.tsx exist with Table/List wrappers</done>
</task>

<task type="auto">
  <name>Task 3: Create FileContext composite</name>
  <files>src/composites/FileContext.tsx</files>
  <action>
Create FileContext composite that wraps ExecutionContext with enhanced patterns.

**Value-add over raw ExecutionContext:**
- Optional title for the context block
- Simplified API with files (better name than paths)
- Optional content after file list

**Implementation:**
```tsx
import type { ReactNode } from 'react';
import { ExecutionContext } from '../workflow/sections/semantic.js';

/**
 * Enhanced execution context with title and additional content
 *
 * Wraps ExecutionContext with common file reference patterns.
 *
 * @param props - Component props
 * @param props.files - File paths to reference
 * @param props.prefix - Path prefix (default: '@')
 * @param props.title - Optional section title
 * @param props.children - Additional content after file list
 *
 * @example Basic file context
 * ```tsx
 * import { FileContext } from 'react-agentic/composites';
 *
 * <FileContext files={[
 *   "~/.claude/agents/my-agent.md",
 *   ".planning/PROJECT.md"
 * ]} />
 * ```
 *
 * @example With title and content
 * ```tsx
 * <FileContext
 *   title="Reference Files"
 *   files={["/path/to/config.json", "/path/to/schema.ts"]}
 * >
 *   <p>These files contain the configuration and type definitions.</p>
 * </FileContext>
 * ```
 *
 * @see {@link ExecutionContext} for the underlying context primitive
 */
export interface FileContextProps {
  /** File paths to reference (@ prefix added automatically) */
  files: string[];
  /** Path prefix (default: '@') */
  prefix?: string;
  /** Optional section title */
  title?: string;
  /** Additional content after file list */
  children?: ReactNode;
}

export const FileContext = ({
  files,
  prefix,
  title,
  children
}: FileContextProps): ReactNode => {
  return (
    <>
      {title && <p><b>{title}</b></p>}
      <ExecutionContext paths={files} prefix={prefix}>
        {children}
      </ExecutionContext>
    </>
  );
};
```
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit src/composites/FileContext.tsx`
Has JSDoc examples: `grep -c "@example" src/composites/FileContext.tsx` shows 2+
  </verify>
  <done>FileContext.tsx exists with ExecutionContext wrapper</done>
</task>

<task type="auto">
  <name>Task 4: Finalize barrel export and add comprehensive tests</name>
  <files>src/composites/index.ts, tests/composites/presentation.test.ts</files>
  <action>
Update barrel export with all composites and create presentation tests.

**Final src/composites/index.ts:**
```typescript
/**
 * react-agentic/composites - User-definable convenience wrappers
 *
 * Composites wrap primitives to provide enhanced variants with common patterns.
 * Users can import these for "batteries included" behavior, or copy/modify
 * the source code to create custom variants.
 *
 * Import: import { IfElseBlock, LoopWithBreak } from 'react-agentic/composites'
 *
 * @packageDocumentation
 */

// Control flow composites
export { IfElseBlock, type IfElseBlockProps } from './IfElseBlock.js';
export { LoopWithBreak, type LoopWithBreakProps } from './LoopWithBreak.js';

// Agent composites
export { SpawnAgentWithRetry, type SpawnAgentWithRetryProps } from './SpawnAgentWithRetry.js';

// Presentation composites
export { StepSection, type StepSectionProps } from './StepSection.js';
export { DataTable, type DataTableProps } from './DataTable.js';
export { BulletList, type BulletListProps } from './BulletList.js';
export { FileContext, type FileContextProps } from './FileContext.js';
```

**Create tests/composites/presentation.test.ts:**
```typescript
import { describe, it, expect } from 'vitest';
import {
  StepSection, type StepSectionProps,
  DataTable, type DataTableProps,
  BulletList, type BulletListProps,
  FileContext, type FileContextProps,
} from '../../src/composites/index.js';

describe('Presentation Composites', () => {
  describe('StepSection', () => {
    it('should be exported', () => {
      expect(StepSection).toBeDefined();
    });

    it('should have correct props interface', () => {
      const props: StepSectionProps = {
        number: 1,
        name: 'Test Step',
      };
      expect(props).toBeDefined();
    });

    it('should accept substep numbers as strings', () => {
      const props: StepSectionProps = {
        number: '1.1',
        name: 'Substep',
        description: 'A substep',
      };
      expect(props.number).toBe('1.1');
    });
  });

  describe('DataTable', () => {
    it('should be exported', () => {
      expect(DataTable).toBeDefined();
    });

    it('should have correct props interface', () => {
      const props: DataTableProps = {
        rows: [['a', 'b'], ['c', 'd']],
      };
      expect(props).toBeDefined();
    });

    it('should accept optional properties', () => {
      const props: DataTableProps = {
        headers: ['Col1', 'Col2'],
        rows: [['a', 1]],
        caption: 'My Table',
        emptyMessage: 'No data',
        align: ['left', 'right'],
      };
      expect(props.caption).toBe('My Table');
    });
  });

  describe('BulletList', () => {
    it('should be exported', () => {
      expect(BulletList).toBeDefined();
    });

    it('should have correct props interface', () => {
      const props: BulletListProps = {
        items: ['one', 'two', 'three'],
      };
      expect(props).toBeDefined();
    });

    it('should accept title', () => {
      const props: BulletListProps = {
        items: ['item'],
        title: 'My List',
      };
      expect(props.title).toBe('My List');
    });
  });

  describe('FileContext', () => {
    it('should be exported', () => {
      expect(FileContext).toBeDefined();
    });

    it('should have correct props interface', () => {
      const props: FileContextProps = {
        files: ['/path/to/file.md'],
      };
      expect(props).toBeDefined();
    });

    it('should accept optional properties', () => {
      const props: FileContextProps = {
        files: ['/a.md', '/b.md'],
        prefix: '$',
        title: 'Reference Files',
      };
      expect(props.title).toBe('Reference Files');
    });
  });
});

describe('Complete Composites Export', () => {
  it('should export all 7 composites from barrel', async () => {
    const composites = await import('../../src/composites/index.js');

    // Control flow
    expect(composites.IfElseBlock).toBeDefined();
    expect(composites.LoopWithBreak).toBeDefined();

    // Agent
    expect(composites.SpawnAgentWithRetry).toBeDefined();

    // Presentation
    expect(composites.StepSection).toBeDefined();
    expect(composites.DataTable).toBeDefined();
    expect(composites.BulletList).toBeDefined();
    expect(composites.FileContext).toBeDefined();
  });
});
```
  </action>
  <verify>
All exports present: `grep -c "export.*from" src/composites/index.ts` shows 7
Tests pass: `npm run test:run -- tests/composites/presentation.test.ts`
All tests pass: `npm run test:run`
Build succeeds: `npm run build`
  </verify>
  <done>All composites exported, comprehensive tests pass</done>
</task>

</tasks>

<verification>
1. All 7 composites exist: IfElseBlock, LoopWithBreak, SpawnAgentWithRetry, StepSection, DataTable, BulletList, FileContext
2. All have @example JSDoc blocks
3. All props interfaces exported
4. Barrel export has 7 component exports
5. All tests pass (849+ existing + new composite tests)
6. Build produces dist/composites/ with all files
7. Composite source serves as reference implementation (readable, copyable)
</verification>

<success_criteria>
- [ ] StepSection wraps Step with description support
- [ ] DataTable wraps Table with caption and empty state
- [ ] BulletList wraps List with title support
- [ ] FileContext wraps ExecutionContext with title support
- [ ] All 7 composites exported from src/composites/index.ts
- [ ] All props interfaces exported for user extension
- [ ] Comprehensive tests for presentation composites
- [ ] All existing tests still pass
- [ ] Build produces dist/composites/ directory
- [ ] Phase 32 requirements LIB-01 through LIB-06 satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/32-composite-library/32-04-SUMMARY.md`
</output>
