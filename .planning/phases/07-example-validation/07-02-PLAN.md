---
phase: 07-example-validation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/jsx.d.ts
  - src/index.ts
  - src/parser/transformer.ts
  - tests/parser/transformer.test.ts
  - src/app/commit-helper.tsx
  - docs/examples/command.tsx
  - src/cli/commands/build.ts
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Example TSX file opens without TypeScript errors in IDE"
    - "Bold text in list items stays inline with following content"
    - "Example file lives in src/app/ directory"
    - "Watch mode defaults to src/app/**/*.tsx when no pattern provided"
  artifacts:
    - path: "src/jsx.d.ts"
      provides: "JSX type definitions for Command and Markdown components"
      exports: ["Command", "Markdown"]
    - path: "package.json"
      provides: "@types/react in devDependencies"
      contains: "@types/react"
    - path: "src/app/commit-helper.tsx"
      provides: "Example command in src/app location"
      min_lines: 40
  key_links:
    - from: "src/index.ts"
      to: "src/jsx.d.ts"
      via: "export"
      pattern: "export.*jsx"
    - from: "src/parser/transformer.ts"
      to: "transformListItem"
      via: "JsxText merge logic"
      pattern: "lastChild.*paragraph.*push"
---

<objective>
Close UAT gaps and implement feature requests from Phase 7 verification.

Purpose: Fix TypeScript errors in example TSX, fix list item formatting bug, relocate example to src/app/, and add default watch path.
Output: Working example with full IDE support, correct list item rendering, and improved developer ergonomics.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-example-validation/07-01-SUMMARY.md
@.planning/debug/tsx-typescript-errors.md
@.planning/debug/bold-list-item-newline.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add @types/react and JSX type definitions</name>
  <files>package.json, src/jsx.d.ts, src/index.ts</files>
  <action>
1. Add @types/react to devDependencies in package.json (latest version)

2. Create src/jsx.d.ts with JSX namespace augmentation:
   - Define CommandProps interface: { name: string; description: string; allowedTools?: string[]; children?: React.ReactNode }
   - Define MarkdownProps interface: { children?: React.ReactNode }
   - Augment JSX.IntrinsicElements with Command and Markdown components
   - Use declare global { namespace JSX { ... } } pattern

3. Export the JSX types from src/index.ts:
   - Add: export type * from './jsx.js';

4. Run npm install to install @types/react
  </action>
  <verify>
npm run typecheck passes
Open docs/examples/command.tsx in IDE - no red squiggles for JSX or Command/Markdown
  </verify>
  <done>TypeScript recognizes JSX syntax and Command/Markdown components without errors</done>
</task>

<task type="auto">
  <name>Task 2: Fix list item bold text inline rendering</name>
  <files>src/parser/transformer.ts, tests/parser/transformer.test.ts</files>
  <action>
Fix transformListItem() in src/parser/transformer.ts (lines 334-339):

Current buggy behavior - JsxText always creates new paragraph:
```typescript
if (Node.isJsxText(child)) {
  const text = extractText(child);
  if (text) {
    // BUG: Always creates new paragraph
    children.push({ kind: 'paragraph', children: [{ kind: 'text', value: text }] });
  }
}
```

Fix: Merge JsxText into last paragraph if one exists (same pattern as inline elements at lines 357-363):
```typescript
if (Node.isJsxText(child)) {
  const text = extractText(child);
  if (text) {
    const textNode: InlineNode = { kind: 'text', value: text };
    // Merge into last paragraph if possible
    const lastChild = children[children.length - 1];
    if (lastChild?.kind === 'paragraph') {
      lastChild.children.push(textNode);
    } else {
      children.push({ kind: 'paragraph', children: [textNode] });
    }
  }
}
```

Update test expectation in tests/parser/transformer.test.ts (lines 438-467):
Change test "transforms list item with inline formatting" to expect SINGLE paragraph with bold and text together:
```typescript
expect(list.items[0]).toEqual({
  kind: 'listItem',
  children: [
    {
      kind: 'paragraph',
      children: [
        { kind: 'bold', children: [{ kind: 'text', value: 'bold' }] },
        { kind: 'text', value: 'text' },
      ],
    },
  ],
});
```
  </action>
  <verify>
npm test -- tests/parser/transformer.test.ts passes
Build example and verify: `- **Working directory:** Current git repository` renders inline (no line break)
  </verify>
  <done>List items with bold text followed by plain text render inline without line breaks</done>
</task>

<task type="auto">
  <name>Task 3: Move example to src/app and add default watch path</name>
  <files>src/app/commit-helper.tsx, docs/examples/command.tsx, src/cli/commands/build.ts, tsconfig.json</files>
  <action>
1. Create src/app/ directory

2. Move/copy example from docs/examples/command.tsx to src/app/commit-helper.tsx
   - Keep the same content (commit-helper theme)
   - Delete docs/examples/command.tsx after copy

3. Update src/cli/commands/build.ts to add default pattern for watch mode:
   - When --watch is used AND no patterns are provided, default to 'src/app/**/*.tsx'
   - Modify the argument from required to optional: `.argument('[patterns...]', ...)`
   - Add logic before globby: if (patterns.length === 0 && options.watch) patterns = ['src/app/**/*.tsx'];
   - Keep error for non-watch mode with no patterns

4. Update tsconfig.json include to add src/app:
   - Change "include": ["src/**/*"] - this already covers src/app, no change needed
   - Verify src/app/*.tsx files will be type-checked

5. Delete empty docs/examples directory if now empty
  </action>
  <verify>
src/app/commit-helper.tsx exists with valid content
react-agentic build --watch (no args) watches src/app/**/*.tsx by default
npm run typecheck passes (src/app included in tsconfig)
  </verify>
  <done>Example lives in src/app/, watch mode defaults to src/app/**/*.tsx</done>
</task>

</tasks>

<verification>
After all tasks:
1. npm run typecheck - passes without errors
2. npm test - all tests pass including updated list item test
3. Open src/app/commit-helper.tsx in IDE - no TypeScript errors for JSX/Command/Markdown
4. npx react-agentic build src/app/**/*.tsx - produces valid output
5. Verify list item formatting: `- **Bold:** text` renders inline
6. npx react-agentic build --watch (no patterns) - watches src/app/**/*.tsx
</verification>

<success_criteria>
- @types/react installed and JSX types defined
- Command and Markdown components have TypeScript type definitions
- IDE shows no errors when opening .tsx files with Command/Markdown usage
- List items with `<b>bold</b> text` render as `- **bold** text` (single line)
- Example command.tsx relocated to src/app/commit-helper.tsx
- Watch mode defaults to src/app/**/*.tsx when no pattern provided
- All existing tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/07-example-validation/07-02-SUMMARY.md`
</output>
