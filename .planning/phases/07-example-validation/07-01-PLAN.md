---
phase: 07-example-validation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/examples/command.tsx
autonomous: true

must_haves:
  truths:
    - "Example command.tsx uses valid JSX syntax with all content inside Command wrapper"
    - "Running `react-agentic build` on the example produces valid markdown"
    - "Output markdown has valid YAML frontmatter"
    - "Example demonstrates headings, lists, formatting, XML blocks, and raw markdown"
  artifacts:
    - path: "docs/examples/command.tsx"
      provides: "Working example of react-agentic command file"
      min_lines: 40
    - path: ".claude/commands/command.md"
      provides: "Transpiled markdown output from example"
      contains: "---"
  key_links:
    - from: "docs/examples/command.tsx"
      to: ".claude/commands/command.md"
      via: "transpilation via react-agentic build"
      pattern: "react-agentic build"
---

<objective>
Fix the invalid JSX in `docs/examples/command.tsx` and validate that the transpiler produces correct Claude Code command markdown.

Purpose: This is the final validation phase - proving the transpiler works end-to-end with a comprehensive example that demonstrates all supported features.
Output: A working example TSX file that transpiles to valid Claude Code command format.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-example-validation/07-RESEARCH.md

Current problem in docs/examples/command.tsx:
- Line 8 has self-closing `<Command ... />` tag
- Lines 10-23 have content OUTSIDE the Command wrapper
- This is invalid JSX - parser cannot find the root element

Fix approach:
- Remove self-closing `/` on line 8
- Ensure all content is INSIDE `<Command>...</Command>` tags
- Add demonstration of all features: headings, lists, formatting, XML blocks, Markdown passthrough

Key syntax requirements (from research pitfalls):
- JSX whitespace: Use `{' '}` for explicit spacing between inline elements
- Curly braces in code: May need escaping in pre/code blocks
- camelCase props: `allowedTools` not `allowed-tools` in TSX
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix and expand example command.tsx</name>
  <files>docs/examples/command.tsx</files>
  <action>
Replace the contents of `docs/examples/command.tsx` with a comprehensive working example:

```tsx
export default function CommitHelperCommand() {
  return (
    <Command
      name="commit-helper"
      description="Helps create well-formatted git commits"
      allowedTools={['Bash', 'Read']}
    >
      <h2>Objective</h2>
      <p>
        Analyze staged changes and generate a commit message following{' '}
        <a href="https://www.conventionalcommits.org">conventional commits</a>{' '}
        format.
      </p>

      <h2>Context</h2>
      <ul>
        <li><b>Working directory:</b> Current git repository</li>
        <li><b>Staged changes:</b> Available via git diff --cached</li>
      </ul>

      <div name="instructions">
        <h3>Process</h3>
        <ol>
          <li>Run <code>git diff --cached</code> to see staged changes</li>
          <li>Analyze the type of changes (feat, fix, docs, etc.)</li>
          <li>Generate a commit message with scope if applicable</li>
        </ol>
      </div>

      <h2>Success Criteria</h2>
      <ul>
        <li>Commit message follows conventional commits format</li>
        <li>Message accurately describes the changes</li>
        <li>Scope is included when changes are focused on one area</li>
      </ul>

      <hr />

      <Markdown>
## Examples

- `feat(auth): add OAuth2 login flow`
- `fix(api): handle null response from upstream`
- `docs: update README with installation steps`
      </Markdown>
    </Command>
  );
}
```

Key changes from original:
- `<Command>` is now opening tag (not self-closing)
- All content is INSIDE the Command wrapper
- Added `{' '}` for explicit JSX whitespace around link
- Added `<div name="instructions">` to demonstrate XML blocks
- Added `<Markdown>` to demonstrate raw passthrough
- Added proper export default function pattern
- Added ordered list, unordered list, links, bold, code, hr
  </action>
  <verify>
- File syntax is valid: `npx tsc --noEmit docs/examples/command.tsx` (or rely on build)
- File has opening `<Command` and closing `</Command>` (not self-closing)
- All h2, ul, div, Markdown elements are INSIDE Command tags
  </verify>
  <done>Example file has valid JSX structure with all content inside Command wrapper</done>
</task>

<task type="auto">
  <name>Task 2: Validate transpilation output</name>
  <files>.claude/commands/command.md</files>
  <action>
Build the example and verify the output:

1. Build the project (if not already built):
   ```bash
   npm run build
   ```

2. Run the transpiler on the example:
   ```bash
   node dist/cli/index.js build 'docs/examples/*.tsx'
   ```

3. Verify the output at `.claude/commands/command.md` contains:
   - YAML frontmatter with `name: commit-helper`, `description: ...`, `allowed-tools: [...]`
   - `## Objective` heading
   - Link to conventional commits in markdown format `[text](url)`
   - `## Context` heading with bullet list
   - `<instructions>` XML block wrapping Process section
   - `## Success Criteria` heading with bullet list
   - `---` horizontal rule
   - `## Examples` from Markdown passthrough

4. Verify the output is valid Claude Code command format:
   - Frontmatter between `---` delimiters
   - No JSX artifacts in output
   - Clean markdown formatting

If any issues found, fix docs/examples/command.tsx and re-run until output is correct.
  </action>
  <verify>
- `node dist/cli/index.js build 'docs/examples/*.tsx'` exits with code 0
- `.claude/commands/command.md` exists
- File starts with `---` (YAML frontmatter)
- Contains `name: commit-helper`
- Contains `allowed-tools:` with array items
- Contains `<instructions>` and `</instructions>` XML block
- Contains `## Examples` from Markdown passthrough
  </verify>
  <done>Transpiler produces valid Claude Code command markdown from example</done>
</task>

</tasks>

<verification>
After all tasks:

1. Confirm example file is syntactically valid:
   ```bash
   head -20 docs/examples/command.tsx
   ```
   Should show `<Command` opening tag with content inside.

2. Run full transpilation:
   ```bash
   npm run build && node dist/cli/index.js build 'docs/examples/*.tsx'
   ```
   Should show green checkmark and success message.

3. Inspect output:
   ```bash
   cat .claude/commands/command.md
   ```

   Expected structure:
   ```markdown
   ---
   name: commit-helper
   description: Helps create well-formatted git commits
   allowed-tools:
     - Bash
     - Read
   ---

   ## Objective

   Analyze staged changes and generate a commit message following [conventional commits](https://www.conventionalcommits.org) format.

   ## Context

   - **Working directory:** Current git repository
   - **Staged changes:** Available via git diff --cached

   <instructions>
   ### Process

   1. Run `git diff --cached` to see staged changes
   2. Analyze the type of changes (feat, fix, docs, etc.)
   3. Generate a commit message with scope if applicable

   </instructions>

   ## Success Criteria

   - Commit message follows conventional commits format
   - Message accurately describes the changes
   - Scope is included when changes are focused on one area

   ---

   ## Examples

   - `feat(auth): add OAuth2 login flow`
   - `fix(api): handle null response from upstream`
   - `docs: update README with installation steps`
   ```

4. Verify the output could be used as a Claude Code command:
   - Valid YAML frontmatter
   - Proper markdown structure
   - XML blocks properly formatted
</verification>

<success_criteria>
- docs/examples/command.tsx has valid JSX with all content inside `<Command>` wrapper
- `react-agentic build docs/examples/*.tsx` completes successfully (exit code 0)
- Output `.claude/commands/command.md` has valid YAML frontmatter
- Output demonstrates all supported features: headings, paragraphs, lists (ul/ol), links, bold, code, XML blocks, hr, Markdown passthrough
- No transpilation errors or warnings
</success_criteria>

<output>
After completion, create `.planning/phases/07-example-validation/07-01-SUMMARY.md`
</output>
